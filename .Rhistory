FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
Overall_Linegraph
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c(NA, "orange", NA) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
Overall_Linegraph
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c(NA, "orange", NA)) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
Overall_Linegraph
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c(NA, "orange", NA)) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
Overall_Linegraph
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_colour(guide = "none")
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_colour(guide = "none") +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c(NA, "orange", NA)) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_color(guide = "none") +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c(NA, "orange", NA)) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_size(guide = "none") +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c(NA, "orange", NA)) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
Overall_Linegraph
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", "Disqualified"))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", "Disqualified"),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", "Disqualified"),
values = c(NA, "orange", NA)) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
Overall_Linegraph
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", "Disqualified"))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", "Disqualified"),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", "Disqualified"),
values = c(NA, "orange", NA)) +
scale_shape_manual(c("Clinched Playoff", "World Champion", "Disqualified"),
values = c(21, 19, 1)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
Overall_Linegraph
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c(NA, "orange", NA)) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
Overall_Linegraph
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c(NA, "orange", NA)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
Overall_Linegraph
TeamsStd <- mutate(TeamsStd,
FranchID = ifelse(teamIDBR == "ANA" | teamIDBR == "CAL" | teamIDBR == "LAA", "LAA",
ifelse(teamIDBR == "FLA" | teamIDBR == "MIA", "MIA",
ifelse(teamIDBR == "MON" | teamIDBR == "WAS" | teamIDBR == "WSN", "WSN",
ifelse(teamIDBR == "TBD" | teamIDBR == "TBR", "TBR",
teamIDBR)
)
)
),
clinch_ps = ifelse((DivWin == "Y" | WCWin == "Y") & WSWin == "N", "Clinched Playoff",
ifelse(WSWin == "Y", "World Champion", NA))
)
TeamsOverall <- TeamsStd %>%
filter(Season >= 1995)
TeamsOverall$OverallRank <- as.integer(TeamsOverall$OverallRank)
Overall_Linegraph <- ggplot(TeamsOverall, aes(x = Season, y = OverallRank)) +
geom_line(color = "navajowhite4", size = .8) +
geom_point(aes(color = clinch_ps, shape = clinch_ps)) +
guides(color = FALSE) +
scale_shape_manual(c("Clinched Playoff", "World Champion", NA),
values = c(21, 19, 1)) +
scale_colour_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("darkblue", "darkblue", "navajowhite4")) +
scale_fill_manual(breaks = c("Clinched Playoff", "World Champion", NA),
values = c("orange", "orange", NA)) +
scale_y_reverse(breaks = c(1,30)) +
facet_wrap(~ FranchID, ncol = 5) +
labs(title = "Overall rank of MLB teams in regular season",
subtitle = "based on WLP in Wild Card Eras (since 1995)",
caption = "Data from Lahman R package 5.0-0")+
theme_tufte() +
theme(axis.ticks = element_blank(),
panel.grid.major.y = element_line(colour = "gray", linetype = "dotted", size = 0.1),
panel.grid.minor.y = element_blank(),
#panel.grid.minor = element_line(colour = "gray", linetype = "dotted", size = 0.3),
#panel.grid.major = element_line(colour = "gray", linetype = "dotted", size = 0.1),
strip.text.x = element_text(size = 10, family = "serif", face = "bold", colour = "black", angle = 0),
axis.text.x=element_text(angle = 90, hjust = 0, vjust = 1, size = 7),
axis.text.y=element_text(angle = 0, hjust = 1, vjust = 0.5, size = 6)) +
scale_x_continuous(breaks = seq(1995, 2020, 5))
Overall_Linegraph
